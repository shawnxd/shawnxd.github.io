<?xml version="1.0" encoding="UTF-8"?>
<svg width="1000" height="600" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <style>
      .component { fill: #e3f2fd; stroke: #1976d2; stroke-width: 2; rx: 8; }
      .loadbalancer { fill: #fff3e0; stroke: #f57c00; stroke-width: 2; rx: 8; }
      .database { fill: #f3e5f5; stroke: #7b1fa2; stroke-width: 2; rx: 8; }
      .cache { fill: #e8f5e8; stroke: #388e3c; stroke-width: 2; rx: 8; }
      .queue { fill: #ffebee; stroke: #d32f2f; stroke-width: 2; rx: 8; }
      .text { font-family: Arial, sans-serif; font-size: 12px; }
      .title { font-family: Arial, sans-serif; font-size: 14px; font-weight: bold; }
      .arrow { stroke: #333; stroke-width: 2; marker-end: url(#arrowhead); }
      .cluster { stroke-dasharray: 5,5; stroke: #666; stroke-width: 1; fill: none; }
    </style>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#333" />
    </marker>
  </defs>
  
  <!-- Background -->
  <rect width="1000" height="600" fill="white"/>
  
  <!-- Title -->
  <text x="500" y="30" text-anchor="middle" class="title">Chat System Scaling Strategy</text>
  
  <!-- Load Balancer -->
  <rect x="400" y="60" width="200" height="40" class="loadbalancer"/>
  <text x="500" y="80" text-anchor="middle" class="title">Load Balancer</text>
  <text x="500" y="95" text-anchor="middle" class="text">(HAProxy/Nginx)</text>
  
  <!-- API Gateway Cluster -->
  <rect x="50" y="120" width="900" height="80" class="cluster"/>
  <text x="500" y="140" text-anchor="middle" class="title">API Gateway Cluster</text>
  <rect x="80" y="150" width="120" height="40" class="component"/>
  <text x="140" y="170" text-anchor="middle" class="text">Gateway 1</text>
  <rect x="220" y="150" width="120" height="40" class="component"/>
  <text x="280" y="170" text-anchor="middle" class="text">Gateway 2</text>
  <rect x="360" y="150" width="120" height="40" class="component"/>
  <text x="420" y="170" text-anchor="middle" class="text">Gateway 3</text>
  <rect x="500" y="150" width="120" height="40" class="component"/>
  <text x="560" y="170" text-anchor="middle" class="text">Gateway 4</text>
  <rect x="640" y="150" width="120" height="40" class="component"/>
  <text x="700" y="170" text-anchor="middle" class="text">Gateway 5</text>
  <rect x="780" y="150" width="120" height="40" class="component"/>
  <text x="840" y="170" text-anchor="middle" class="text">Gateway 6</text>
  
  <!-- Service Layer -->
  <rect x="50" y="220" width="900" height="120" class="cluster"/>
  <text x="500" y="240" text-anchor="middle" class="title">Microservices Layer</text>
  
  <!-- Chat Service Cluster -->
  <rect x="80" y="250" width="100" height="30" class="component"/>
  <text x="130" y="267" text-anchor="middle" class="text">Chat 1</text>
  <rect x="80" y="290" width="100" height="30" class="component"/>
  <text x="130" y="307" text-anchor="middle" class="text">Chat 2</text>
  <rect x="80" y="330" width="100" height="30" class="component"/>
  <text x="130" y="347" text-anchor="middle" class="text">Chat 3</text>
  
  <!-- Presence Service Cluster -->
  <rect x="200" y="250" width="100" height="30" class="component"/>
  <text x="250" y="267" text-anchor="middle" class="text">Presence 1</text>
  <rect x="200" y="290" width="100" height="30" class="component"/>
  <text x="250" y="307" text-anchor="middle" class="text">Presence 2</text>
  
  <!-- Notification Service -->
  <rect x="320" y="250" width="100" height="30" class="component"/>
  <text x="370" y="267" text-anchor="middle" class="text">Notification 1</text>
  <rect x="320" y="290" width="100" height="30" class="component"/>
  <text x="370" y="307" text-anchor="middle" class="text">Notification 2</text>
  
  <!-- WebSocket Cluster -->
  <rect x="440" y="250" width="100" height="30" class="component"/>
  <text x="490" y="267" text-anchor="middle" class="text">WS 1</text>
  <rect x="440" y="290" width="100" height="30" class="component"/>
  <text x="490" y="307" text-anchor="middle" class="text">WS 2</text>
  <rect x="440" y="330" width="100" height="30" class="component"/>
  <text x="490" y="347" text-anchor="middle" class="text">WS 3</text>
  
  <!-- Message Queue -->
  <rect x="560" y="250" width="100" height="30" class="queue"/>
  <text x="610" y="267" text-anchor="middle" class="text">Kafka 1</text>
  <rect x="560" y="290" width="100" height="30" class="queue"/>
  <text x="610" y="307" text-anchor="middle" class="text">Kafka 2</text>
  <rect x="560" y="330" width="100" height="30" class="queue"/>
  <text x="610" y="347" text-anchor="middle" class="text">Kafka 3</text>
  
  <!-- Other Services -->
  <rect x="680" y="250" width="100" height="30" class="component"/>
  <text x="730" y="267" text-anchor="middle" class="text">Media 1</text>
  <rect x="680" y="290" width="100" height="30" class="component"/>
  <text x="730" y="307" text-anchor="middle" class="text">Search 1</text>
  
  <!-- Data Layer -->
  <rect x="50" y="360" width="900" height="120" class="cluster"/>
  <text x="500" y="380" text-anchor="middle" class="title">Data & Infrastructure Layer</text>
  
  <!-- Database Cluster -->
  <rect x="80" y="390" width="100" height="30" class="database"/>
  <text x="130" y="407" text-anchor="middle" class="text">DB Master</text>
  <rect x="80" y="430" width="100" height="30" class="database"/>
  <text x="130" y="447" text-anchor="middle" class="text">DB Slave 1</text>
  <rect x="80" y="470" width="100" height="30" class="database"/>
  <text x="130" y="487" text-anchor="middle" class="text">DB Slave 2</text>
  
  <!-- Redis Cluster -->
  <rect x="200" y="390" width="100" height="30" class="cache"/>
  <text x="250" y="407" text-anchor="middle" class="text">Redis 1</text>
  <rect x="200" y="430" width="100" height="30" class="cache"/>
  <text x="250" y="447" text-anchor="middle" class="text">Redis 2</text>
  <rect x="200" y="470" width="100" height="30" class="cache"/>
  <text x="250" y="487" text-anchor="middle" class="text">Redis 3</text>
  
  <!-- ElasticSearch -->
  <rect x="320" y="390" width="100" height="30" class="database"/>
  <text x="370" y="407" text-anchor="middle" class="text">ES 1</text>
  <rect x="320" y="430" width="100" height="30" class="database"/>
  <text x="370" y="447" text-anchor="middle" class="text">ES 2</text>
  <rect x="320" y="470" width="100" height="30" class="database"/>
  <text x="370" y="487" text-anchor="middle" class="text">ES 3</text>
  
  <!-- Object Storage -->
  <rect x="440" y="390" width="100" height="30" class="database"/>
  <text x="490" y="407" text-anchor="middle" class="text">S3/CDN</text>
  
  <!-- Push Services -->
  <rect x="560" y="390" width="100" height="30" class="component"/>
  <text x="610" y="407" text-anchor="middle" class="text">FCM</text>
  <rect x="560" y="430" width="100" height="30" class="component"/>
  <text x="610" y="447" text-anchor="middle" class="text">APNS</text>
  
  <!-- Monitoring -->
  <rect x="680" y="390" width="100" height="30" class="component"/>
  <text x="730" y="407" text-anchor="middle" class="text">Prometheus</text>
  <rect x="680" y="430" width="100" height="30" class="component"/>
  <text x="730" y="447" text-anchor="middle" class="text">Grafana</text>
  
  <!-- Arrows -->
  <line x1="500" y1="100" x2="500" y2="120" class="arrow"/>
  <line x1="500" y1="200" x2="500" y2="220" class="arrow"/>
  <line x1="500" y1="340" x2="500" y2="360" class="arrow"/>
  
  <!-- Scaling Indicators -->
  <text x="50" y="520" class="title">Scaling Strategies:</text>
  <text x="50" y="540" class="text">• <strong>Horizontal Scaling</strong>: Multiple instances of each service</text>
  <text x="50" y="560" class="text">• <strong>Load Balancing</strong>: Distribute traffic across instances</text>
  <text x="50" y="580" class="text">• <strong>Database Sharding</strong>: Partition data across multiple databases</text>
  <text x="50" y="600" class="text">• <strong>Caching</strong>: Redis cluster for session and presence data</text>
</svg> 